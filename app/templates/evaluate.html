{% extends "base.html" %}

{% block title %}Evaluaci√≥n - AI Judges Panel{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <!-- Header -->
            <div class="text-center mb-5">
                <h1 class="display-5 text-gradient">
                    <i class="fas fa-clipboard-check me-3"></i>
                    Evaluaci√≥n Inteligente
                </h1>
                <p class="lead">
                    Ingresa tu prompt y respuesta para obtener una evaluaci√≥n comprehensiva 
                    usando nuestro panel de jueces especializados de IA
                </p>
            </div>

            <!-- Evaluation Form -->
            <div class="evaluation-form shadow-custom">
                <form id="evaluation-form">
                    <div class="mb-4">
                        <label for="prompt" class="form-label">
                            <i class="fas fa-question-circle me-2"></i>
                            <strong>Prompt Original</strong>
                        </label>
                        <textarea 
                            class="form-control" 
                            id="prompt" 
                            name="prompt" 
                            rows="4" 
                            placeholder="Escribe aqu√≠ la pregunta o tarea que fue planteada al LLM..."
                            required
                            minlength="10"
                            maxlength="2000">
                        </textarea>
                        <div class="form-text">
                            Ingresa la pregunta o instrucci√≥n original que se le dio al modelo de IA.
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="response" class="form-label">
                            <i class="fas fa-robot me-2"></i>
                            <strong>Respuesta del LLM</strong>
                        </label>
                        <textarea 
                            class="form-control" 
                            id="response" 
                            name="response" 
                            rows="8" 
                            placeholder="Pega aqu√≠ la respuesta generada por el LLM que quieres evaluar..."
                            required
                            minlength="10"
                            maxlength="5000">
                        </textarea>
                        <div class="form-text">
                            Ingresa la respuesta completa que gener√≥ el modelo de IA.
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="domain" class="form-label">
                                <i class="fas fa-tag me-2"></i>
                                <strong>Dominio (Opcional)</strong>
                            </label>
                            <select class="form-select" id="domain" name="domain">
                                <option value="">Seleccionar dominio...</option>
                                <option value="general">General</option>
                                <option value="technical">T√©cnico</option>
                                <option value="creative">Creativo</option>
                                <option value="academic">Acad√©mico</option>
                                <option value="business">Negocios</option>
                                <option value="medical">M√©dico</option>
                                <option value="legal">Legal</option>
                                <option value="educational">Educativo</option>
                            </select>
                            <div class="form-text">
                                Ayuda a contextualizar la evaluaci√≥n.
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-cogs me-2"></i>
                                <strong>Opciones Avanzadas</strong>
                            </label>
                            <div class="form-check mt-2">
                                <input 
                                    class="form-check-input" 
                                    type="checkbox" 
                                    id="include_automatic_metrics" 
                                    name="include_automatic_metrics" 
                                    checked>
                                <label class="form-check-label" for="include_automatic_metrics">
                                    Incluir m√©tricas autom√°ticas
                                </label>
                            </div>
                            <div class="form-text">
                                Incluye m√©tricas adicionales de NLP cuando sea posible.
                            </div>
                        </div>
                    </div>

                    <!-- Model Information -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="alert alert-info d-flex align-items-center">
                                <i class="fas fa-robot fa-2x me-3"></i>
                                <div>
                                    <strong>Modelo de Evaluaci√≥n:</strong> OpenAI GPT-2<br>
                                    <small class="text-muted">Evaluaci√≥n contextual usando inteligencia artificial. Tiempo estimado: ~5-8 segundos.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Examples -->
                    <div class="mb-4">
                        <button type="button" class="btn btn-outline-info btn-sm" onclick="loadExample()">
                            <i class="fas fa-lightbulb me-1"></i>Cargar Ejemplo
                        </button>
                        <button type="button" class="btn btn-outline-secondary btn-sm ms-2" onclick="clearForm()">
                            <i class="fas fa-eraser me-1"></i>Limpiar
                        </button>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-play me-2"></i>Evaluar Respuesta
                        </button>
                    </div>
                </form>
            </div>

            <!-- Loading Spinner -->
            <div id="loading-spinner" class="text-center mt-4" style="display: none;">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Evaluando...</span>
                </div>
                <p class="mt-2 text-muted">
                    Nuestro panel de jueces est√° analizando la respuesta...
                </p>
            </div>

            <!-- Results Container -->
            <div id="results-container" class="results-container fade-in" style="display: none;">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>

        <!-- Sidebar with Info -->
        <div class="col-lg-4">
            <div class="sticky-top" style="top: 2rem;">
                <!-- Judge Info -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-robot me-2"></i>GPT-2 AI Judge
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-6 mb-3">
                                <div class="judge-mini-card">
                                    <div class="judge-icon text-warning">üé™</div>
                                    <small><strong>Relevancia</strong></small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="judge-mini-card">
                                    <div class="judge-icon text-primary">üß†</div>
                                    <small><strong>Coherencia</strong></small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="judge-mini-card">
                                    <div class="judge-icon text-danger">üéØ</div>
                                    <small><strong>Precisi√≥n</strong></small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="judge-mini-card">
                                    <div class="judge-icon text-success">‚úÖ</div>
                                    <small><strong>Completitud</strong></small>
                                </div>
                            </div>
                        </div>
                        <small class="text-muted">
                            GPT-2 eval√∫a la respuesta en estos cuatro aspectos clave 
                            utilizando evaluaci√≥n contextual con inteligencia artificial.
                        </small>
                    </div>
                </div>

                <!-- Tips Card -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-tips me-2"></i>Consejos para Mejores Resultados
                        </h6>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0 small">
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Incluye el prompt completo y espec√≠fico
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Pega la respuesta completa del LLM
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Selecciona el dominio apropiado si conoces el contexto
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                La evaluaci√≥n toma 10-30 segundos
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- API Info -->
                <div class="card shadow-sm">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-code me-2"></i>¬øDesarrollador?
                        </h6>
                    </div>
                    <div class="card-body">
                        <p class="small mb-2">
                            Utiliza nuestra API REST para integrar la evaluaci√≥n 
                            en tu aplicaci√≥n.
                        </p>
                        <a href="/api/v1/docs" target="_blank" class="btn btn-outline-info btn-sm">
                            <i class="fas fa-external-link-alt me-1"></i>Ver Documentaci√≥n
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.judge-mini-card {
    padding: 10px;
    border-radius: 8px;
    background: #f8f9fa;
    transition: all 0.3s ease;
}

.judge-mini-card:hover {
    background: #e9ecef;
    transform: scale(1.05);
}

.judge-icon {
    font-size: 1.5rem;
    margin-bottom: 5px;
}

.sticky-top {
    position: -webkit-sticky;
    position: sticky;
}

@media (max-width: 991px) {
    .sticky-top {
        position: relative;
        top: auto !important;
    }
}
</style>
{% endblock %}

{% block extra_scripts %}
<script>
// Load example data
function loadExample() {
    document.getElementById('prompt').value = `Explica qu√© es la inteligencia artificial y c√≥mo est√° transformando diferentes industrias en la actualidad. Incluye ejemplos espec√≠ficos y menciona tanto beneficios como desaf√≠os.`;
    
    document.getElementById('response').value = `La inteligencia artificial (IA) es una rama de la ciencia de la computaci√≥n que se enfoca en crear sistemas capaces de realizar tareas que tradicionalmente requieren inteligencia humana, como el aprendizaje, el reconocimiento de patrones, la toma de decisiones y el procesamiento del lenguaje natural.

**Transformaci√≥n por industrias:**

**Salud:** Los algoritmos de IA ayudan en el diagn√≥stico m√©dico mediante el an√°lisis de im√°genes m√©dicas, predicen brotes de enfermedades y personalizan tratamientos. Por ejemplo, Google's DeepMind ha desarrollado sistemas que pueden detectar m√°s de 50 enfermedades oculares.

**Finanzas:** Los bancos utilizan IA para detectar fraudes en tiempo real, automatizar el trading algor√≠tmico y evaluar riesgos crediticios. JPMorgan Chase usa IA para analizar contratos legales en segundos.

**Transporte:** Los veh√≠culos aut√≥nomos de Tesla y Waymo est√°n revolucionando la movilidad. Los sistemas de optimizaci√≥n de rutas en aplicaciones como Waze utilizan IA para reducir tiempos de viaje.

**Educaci√≥n:** Plataformas como Khan Academy usan IA para personalizar el aprendizaje, adaptando el contenido al ritmo y estilo de cada estudiante.

**Beneficios principales:**
- Automatizaci√≥n de tareas repetitivas
- Mayor precisi√≥n en an√°lisis complejos
- Disponibilidad 24/7
- Procesamiento de grandes vol√∫menes de datos

**Desaf√≠os importantes:**
- P√©rdida potencial de empleos
- Sesgo algor√≠tmico
- Privacidad y seguridad de datos
- Dependencia tecnol√≥gica
- Falta de transparencia en decisiones algor√≠tmicas

La IA continuar√° evolucionando, siendo crucial equilibrar la innovaci√≥n con consideraciones √©ticas y sociales.`;
    
    document.getElementById('domain').value = 'technical';
    
    // Auto-resize textareas
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.style.height = 'auto';
        textarea.style.height = (textarea.scrollHeight) + 'px';
    });
}

// Clear form
function clearForm() {
    document.getElementById('evaluation-form').reset();
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.style.height = 'auto';
    });
    hideResults();
}

// No model selector needed - using GPT-2 only

// Auto-resize textareas on input
document.querySelectorAll('textarea').forEach(textarea => {
    textarea.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    });
});
</script>
{% endblock %}
